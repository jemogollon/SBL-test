<!DOCTYPE html>
<html>

<head>
    <script
    id="fsc-api"
    src="https://d1f8f9xcsvx3ha.cloudfront.net/sbl/0.8.5/fastspring-builder.min.js"
    type="text/javascript"
    data-storefront="juanstore.test.onfastspring.com"
    data-access-key="S3SZ-YRZQHAQIBYOM958QG"
    data-data-callback="dataCallback"
    data-continuous="true">
</script>
<script>
function pushToFastSpring() {
        
        // Retrieve the customer data from the web page
        
        var firstName = document.getElementById("fname").value;
        var lastName = document.getElementById("lname").value;
        var emailAddress = document.getElementById("email").value;
        var discountPercent = document.getElementById("customDiscount").value;
       
        // Reset the contents of any pre-existing order session
        
        fastspring.builder.reset();
        
        // Create and pass a payload containing information about the current order session, including the customer data. This will hide the fields that are already populated.
        
        // Documentation: https://fastspring.com/docs/passing-sensitive-data-with-secure-requests/
        
        // For this demo concerning TNP-107095 we are passing a discount % to the order session.
        
            fastspring.builder.secure(
                {
                    "contact": {
              "email":emailAddress,
              "firstName":firstName,
              "lastName":lastName,
              "country": "NL",
              },
            "language": "EN",
                    "items": 
                        [
                               {
                                "product": "book",
                                "quantity": 1,
                    "pricing": {
                    "discountType": "percent",
                        "quantityDiscounts": {  
                          1:discountPercent
                        }
                    }
                  }
                         ]
                });
        
        // Launch the checkout.
            fastspring.builder.checkout();
        }
</script>
</head>
<body>

  
    <div class="column" style="background-color: whiteSmoke; padding:20px; border-radius: 25px;"> 

        <!-- Enter the customer details for demo purposes-->
        <form>
          <label for="fname">First name:</label>
          <input type="text" id="fname" name="fname" value="Adam"><br><br>
          <label for="lname">Last name:</label>
          <input type="text" id="lname" name="lname" value="Harvey"><br><br>
    
          <label for="email">Email:</label>
          <input type="text" id="email" name="email" value="jmogollon@fastspring.com"><br><br>
          
          <!-- Discount amount to be applied to the order session for TNP-107095 -->
          <label for="customDiscount">Discount to Apply:</label>
          <input type="text" id="customDiscount" name="customDiscount" value="15">%<br><br>
        </form>
    
        <!-- Call a custom function to prepopulate the order session and launch the checkout -->
        <button onclick="pushToFastSpring();">Buy Now</button>
        <script type="javascript">
            
        </script>
    
      </div>

</body>
</html>
